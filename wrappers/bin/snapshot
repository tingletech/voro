#!/bin/sh

# Call setup program. Assumes location is VORO wrapper root.
root=`dirname $0`;
. $root/../setup.sh

notifyOps () {
	voromail "$1"
	echo $1 2>&1 | tee -a $LOGFILE
}
LOGFILE=${LOGDIR}/snapshot_${TIMESTAMP}

# CVS Commit [VORO update #1]
cd $CDLDATA/prime2002
cvs -d $HOME/data/cvsdata import -m "auto $DATE" oac-ead/prime2002 voro r$DATE >> $LOGFILE 2>&1
if [ $? -ne 0 ]; then
	notifyOps "1 [ERROR] SNAPSHOT cvs import. See log: $LOGFILE"
	exit 1
fi

# CVS Commit [VORO update #1]
cd $CDLDATA/remove
cvs -d $HOME/data/cvsdata import -m "auto $DATE" oac-ead/remove voro r$DATE >> $LOGFILE 2>&1
if [ $? -ne 0 ]; then
	notifyOps "2 [ERROR] SNAPSHOT cvs import. See log: $LOGFILE"
	exit 1
fi

# CVS Commit [VORO update #1]
cd $CDLDATA/submission
cvs -d $HOME/data/cvsdata import -m "auto $DATE" oac-ead/submission voro r$DATE >> $LOGFILE 2>&1
if [ $? -ne 0 ]; then
	notifyOps "3 [ERROR] SNAPSHOT cvs import. See log: $LOGFILE"
	exit 1
fi

# CVS Update [VORO update #1]
cd $CDLDLXS

cd ..
cvs -d $HOME/data/cvsdata checkout -AP -r r$DATE oac-ead/prime2002 oac-ead/remove >> $LOGFILE 2>&1
if [ $? -ne 0 ]; then
	notifyOps "4 [ERROR] SNAPSHOT cvs update. See log: $LOGFILE"
	exit 1
fi

exit 0
